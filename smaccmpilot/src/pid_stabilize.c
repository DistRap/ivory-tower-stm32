/* This file has been autogenerated by Ivory
 * Compiler version  b48fa4470fb0630f5faec99220f1a507651451af
 */
#include "pid_stabilize.h"
float constrain(float n_var0, float n_var1, float n_var2)
{
    if ((float) n_var2 < (float) n_var0) {
        return n_var0;
    } else {
        if ((float) n_var2 > (float) n_var1) {
            return n_var1;
        } else {
            return n_var2;
        }
    }
}
float pid_update(struct PID* n_var0, float n_var1)
{
    float n_deref0 = *&n_var0->pid_pGain;
    float n_deref1 = *&n_var0->pid_iMin;
    float n_deref2 = *&n_var0->pid_iMax;
    float n_deref3 = *&n_var0->pid_iState;
    float n_r4 = constrain(n_deref1, n_deref2, n_deref3 + n_var1);
    
    *&n_var0->pid_iState = n_r4;
    
    float n_deref5 = *&n_var0->pid_iGain;
    float n_deref6 = *&n_var0->pid_iState;
    
    return n_deref0 * n_var1 + n_deref5 * n_deref6;
}
float stabilize_from_angle(struct PID* n_var0, struct PID* n_var1, float n_var2,
                           float n_var3, float n_var4, float n_var5,
                           float n_var6)
{
    float n_let0 = n_var2 * n_var3;
    float n_let1 = n_var4 * 57.29578F;
    float n_let2 = n_let0 - n_let1;
    float n_r3 = pid_update(n_var0, n_let2);
    float n_let4 = n_var5 * 57.29578F;
    float n_let5 = n_r3 - n_let4;
    float n_r6 = pid_update(n_var1, n_let5);
    float n_r7 = constrain(-n_var6, n_var6, n_r6);
    
    return n_r7 / n_var6;
}
float stabilize_from_rate(struct PID* n_var0, float n_var1, float n_var2,
                          float n_var3, float n_var4)
{
    float n_let0 = n_var1 * n_var2;
    float n_let1 = n_var3 * 57.29578F;
    float n_let2 = n_let0 - n_let1;
    float n_r3 = pid_update(n_var0, n_let2);
    float n_r4 = constrain(-n_var4, n_var4, n_r3);
    
    return n_r4 / n_var4;
}
